[Script Info]
; Script generated by Aegisub 9206, Daydream Cafe Edition [Shinon]
; http://www.aegisub.org/
Title: New subtitles
ScriptType: v4.00+
WrapStyle: 0
PlayResX: 1920
PlayResY: 1080
ScaledBorderAndShadow: yes
YCbCr Matrix: TV.709

[Aegisub Project Garbage]
Video File: priconne_07_premux[2515-2664].mp4
Video AR Mode: 4
Video AR Value: 1.777778
Video Zoom Percent: 0.625000
Scroll Position: 42
Active Line: 54

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: why do I even bother,Times New Roman,45,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,-1,0,0,0,100,100,0,0,1,0,0,2,0,0,0,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,ln = _G.require('ln.kara'); ln.init(tenv)
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,_G.require('utils')
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- this isn't based on scrad's template. the codebases kinda branched apart after getting gradients to work, and there's probably been some fine tuning in the other template that's not present here
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- existing functions
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function getpos() local tag = ln.line.tag('pos'); local x, y = string.match(tag, '\\pos%((%d+),(%d+)%)'); return _G.tonumber(x), _G.tonumber(y); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function getleft() local x, y = getpos(); return x - line.width/2; end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function gettop() local x, y = getpos(); return y - line.height; end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function fadetime() local pos = (getleft() + char.center - 450) / (1720 - 450); return _G.interpolate(pos, 166, 875); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function cfade(t1, t2, tags) return ln.tag.t(fadetime() + t1, fadetime() + t2, tags); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function gradclip() local dy = line.height / maxj; local y = gettop() + dy * (j-1); return string.format('\\clip(%.2f,%.2f,%.2f,%.2f)', 0, y, meta.res_x, y+dy); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function gradcolor() local t = (j-1)/(maxj-1); return _G.interpolate_color(t, '&H95FEFE&', '&H54ECFC&'); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- self-explanatory utility functions
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function tag_fsc(val) return string.format('\\fscx%.1f\\fscy%.1f', val, val); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function getparticlepos() local x, y = getleft() + char.left, gettop(); return rnd(x, x+char.width), rnd(y, y+line.height-line.descent/2); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- function for reusing the same randomized value (whatever f returns) for each iteration (j) of each char (ci) in each line (i)
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- there are many alternative ways to do this
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function memoize(f) local cache = {}; return function() local i = orgline.i; local ci = char.ci; cache[i] = cache[i] or {}; cache[i][ci] = cache[i][ci] or {}; cache[i][ci][j] = cache[i][ci][j] or f(); return cache[i][ci][j]; end; end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- hopefully self-explanatory
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,function memo_rnd(a, b) return memoize(function() return rnd(a, b) end); end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- 5-10 particles; also set start and end time
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,local foo, bar, baz = memo_rnd(5, 10), memo_rnd(50, 300), memo_rnd(2500, 5000); function particleloop() maxloop(foo()); retime('preline', fadetime() + bar(), baz()); return ''; end
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- set \pos to a random location within the char's vicinity/bounding box, and \org to somewhere near \pos
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,particlepos = memoize(function() local px, py = getparticlepos(); local ox, oy = px + rnd(-5,5), py + rnd(-5,5); local dsp = line.duration / 500; return string.format("\\an5\\org(%.1f,%.1f)\\move(%.1f,%.1f,%.1f,%.1f)", ox, oy, px, py, px+rnd(-dsp,dsp), py+rnd(-dsp,dsp)); end)
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- random rotation amount based on line duration, so that rotation *speed* is consistent
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,particlefrz = memoize(function() local foo = math.sqrt(line.duration)/2; local amount = rnd(-foo,foo)^2; return string.format('\\t(\\frz%.1f)', amount); end)
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- appear by growing, grow to a random size, then shrink away.
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,particlefsc = memoize(function() return tag_fsc(0) .. ln.tag.t(0, rnd(0, 300), tag_fsc(rnd(25, 125))) .. ln.tag.t(line.duration - rnd(300, 800), line.duration, tag_fsc(0)); end)
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 3,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- text body
Comment: 3,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,template line body loop 30,{!ln.line.tag('pos')!\1a&HFE&\3a&HFE&\shad0.01!gradclip()!}
Comment: 3,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,template lchar body,{\4c&H55EBFF&\4a&HFF&\bord0\blur0!cfade(0,100,'\\4c&HFFFFFF&\\4a&H00&\\bord0.75\\blur1')!!cfade(125,350,'\\bord0\\blur0\\4c'..gradcolor())!}
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 2,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- text shadow
Comment: 2,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,template line shadow,{!ln.line.tag('pos')!\1a&HFE&\3a&HFE&\xshad1\yshad-0.5!gradclip()!\4c&H3F3F3F&}
Comment: 2,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,template lchar shadow,{\4a&HFF&\bord0\blur1!cfade(50,150,'\\4a&H3F&\\bord0.75')!!cfade(175,350,'\\bord1.25')!}
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 1,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- particle body
Comment: 1,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,template char noblank notext,{!particleloop()!!particlefsc()!!particlepos()!!particlefrz()!\fnTimes New Roman\blur1\1c!gc(3)!\1a!ga(3)!}•
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- particle glow
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,template char noblank notext,{!particleloop()!!particlefsc()!!particlepos()!!particlefrz()!\fnTimes New Roman\1a&HFE&\3a&HFE&\4c!gc(4)!\4a!ga(4)!\shad0.01\bord5\blur8}•
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- there's another set of particles that kinda sprinke down, but if we did it on the kanji, it would be layered on top
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- I have come to realize that the color/alpha of the particles is screwed here not (solely) because of my ineptitude in selecting them, but also because of the particles' blending mode.
Comment: 0,0:00:00.00,0:00:00.00,why do I even bother,,0,0,0,code once,-- In any case, you can tweak them here.
Dialogue: 0,0:00:00.00,0:00:06.19,why do I even bother,,0,0,0,karaoke,{\3c&H6BFFFD&\3a&H0F&\4c&H33A1FF&\4a&H5F&\pos(770.333,841)}The Light that Pierces the Darkness
Dialogue: 0,0:00:00.00,0:00:06.19,why do I even bother,,0,0,0,karaoke,{\3c&HFFFFFF&\3a&H00&\4c&HDFAFFF&\4a&H5F&\pos(1351.333,841)}~Like Two Sisters in a Pod~
